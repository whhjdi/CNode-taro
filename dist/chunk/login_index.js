(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"136":function(e,n,t){"use strict";t.r(n);var r=t(142),o=t(0),a=t(139),i=t(40),u=t(1),s=t.n(u),c=t(145),l=(t(34),t(39)),p=t.n(l),f=t(32),h=t.n(f),d=(t(78),Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}),v=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();function getTrueType(e,n,t){if(!e)throw new Error("unexpected type");return"search"===n&&(e="search"),t&&(e="password"),"digit"===e&&(e="number"),e}var y=function(e){function Input(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,Input);var e=function _possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(Input.__proto__||Object.getPrototypeOf(Input)).apply(this,arguments));return e.onInput=e.onInput.bind(e),e.onFocus=e.onFocus.bind(e),e.onBlur=e.onBlur.bind(e),e.onKeyDown=e.onKeyDown.bind(e),e.handleComposition=e.handleComposition.bind(e),e.isOnComposition=!1,e}return function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(Input,s.a.Component),v(Input,[{"key":"componentDidMount","value":function componentDidMount(){"file"===this.props.type&&this.inputRef.addEventListener("change",this.onInput)}},{"key":"componentWillUnMount","value":function componentWillUnMount(){"file"===this.props.type&&this.inputRef.removeEventListener("change",this.onInput)}},{"key":"onInput","value":function onInput(e){var n=this.props,t=n.type,r=n.maxLength,o=n.confirmType,a=n.password,i=n.onInput,onInput=void 0===i?"":i,u=n.onChange,s=void 0===u?"":u;if(!this.isOnComposition){var c=e.target.value,l=getTrueType(t,o,a);if("number"===l&&c&&r<=c.length&&(c=c.substring(0,r),e.target.value=c),Object.defineProperty(e,"detail",{"enumerable":!0,"value":{"value":c}}),!["number","file"].includes(l)){var p=e.target.selectionEnd;setTimeout(function(){e.target.selectionStart=p,e.target.selectionEnd=p})}if(s)return s(e);if(onInput)return onInput(e)}}},{"key":"onFocus","value":function onFocus(e){var onFocus=this.props.onFocus;Object.defineProperty(e,"detail",{"enumerable":!0,"value":{"value":e.target.value}}),onFocus&&onFocus(e)}},{"key":"onBlur","value":function onBlur(e){var onBlur=this.props.onBlur;Object.defineProperty(e,"detail",{"enumerable":!0,"value":{"value":e.target.value}}),onBlur&&onBlur(e)}},{"key":"onKeyDown","value":function onKeyDown(e){var n=this.props.onConfirm;13===e.keyCode&&n&&(Object.defineProperty(e,"detail",{"enumerable":!0,"value":{"value":e.target.value}}),n(e))}},{"key":"handleComposition","value":function handleComposition(e){e.target instanceof HTMLInputElement&&("compositionend"===e.type?this.isOnComposition=!1:this.isOnComposition=!0,this.onInput(e))}},{"key":"render","value":function render(){var e=this,n=this.props,t=n.className,r=void 0===t?"":t,o=n.placeholder,a=n.type,i=void 0===a?"text":a,u=n.password,c=n.disabled,l=n.maxLength,f=n.confirmType,v=void 0===f?"":f,y=n.focus,g=void 0!==y&&y,m=n.value,b=h()("weui-input",r),k=p()(this.props,["className","placeholder","disabled","max","onChange","onFocus","onBlur","type","focus"]);return"value"in this.props&&(k.value=function fixControlledValue(e){return void 0===e||null===e?"":e}(m)),s.a.createElement("input",d({"ref":function ref(n){e.inputRef=n,n&&g&&n.focus()}},k,{"className":b,"placeholder":o,"disabled":c,"max":l,"onInput":this.onInput,"onFocus":this.onFocus,"onBlur":this.onBlur,"autofocus":g,"onKeyDown":this.onKeyDown,"type":getTrueType(i,v,u),"onCompositionStart":this.handleComposition,"onCompositionEnd":this.handleComposition}))}}]),Input}();y.defaultProps={"type":"text"};var g=y,m=t(9),b=(t(80),t(138)),k=t(48),w=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var _=function(e){function Login(){!function login_classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,Login);var e=function login_possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(Login.__proto__||Object.getPrototypeOf(Login)).apply(this,arguments));return e.config={"navigationBarTitleText":"登录","navigationBarBackgroundColor":"#5685E4"},e.state={"token":""},e}return function login_inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(Login,o["a"].Component),w(Login,[{"key":"componentDidMount","value":function componentDidMount(){this.getToken()}},{"key":"getToken","value":function getToken(){var e=this;Object(r.a)({"key":"token"}).then(function(n){n.data&&e.setState({"token":n.data},function(){e.handleLogin()})})}},{"key":"handleInput","value":function handleInput(e){e&&e.target&&this.setState({"token":e.target.value})}},{"key":"handleLogin","value":function(){var e=function _asyncToGenerator(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function step(r,o){try{var a=n[r](o),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(){var e;return regeneratorRuntime.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!(e=this.state.token)){n.next=8;break}return n.next=4,this.props.accessUserToken(e);case 4:n.sent.success?(Object(r.b)("token",e),o.a.redirectTo({"url":"/pages/user/index"})):Object(a.c)({"title":"登录失败"}),n.next=9;break;case 8:Object(a.c)({"title":"请输入accesstoken"});case 9:case"end":return n.stop()}},_callee,this)}));return function handleLogin(){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){return s.a.createElement(c.a,{"className":"login"},s.a.createElement(c.a,{"className":"header"},s.a.createElement(c.a,{"className":"header-avatar"},"快点登录吧")),s.a.createElement(c.a,{"className":"input-wrapper"},s.a.createElement(g,{"type":"password","password":!0,"placeholder":"请输入accesstoken","focus":!0,"className":"login-input","onInput":this.handleInput.bind(this)})),s.a.createElement(b.a,{"type":"primary","circle":!0,"className":"login-button","onClick":this.handleLogin.bind(this)},"登录"))}},{"key":"componentDidShow","value":function componentDidShow(){}}]),Login}();_=i.__decorate([Object(m.b)(function(e){return{"user":e.user}},function(e){return{"accessUserToken":function accessUserToken(n){return e(Object(k.a)(n))}}})],_);n.default=_},"41":function(e,n,t){"use strict";var r=t(139),o=t(146);t(1);var a=function(){var e=function _asyncToGenerator(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function step(r,o){try{var a=n[r](o),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(e,n,t){return regeneratorRuntime.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,i){Object(r.b)(),Object(o.a)({"url":e,"method":n,"data":t,"header":{"content-type":"application/json"}}).then(function(e){Object(r.a)(),a(e)}).catch(function(e){i(e)})}));case 1:case"end":return a.stop()}},_callee,this)}));return function request(n,t,r){return e.apply(this,arguments)}}(),i={"topics":"/topics","topic":"/topic","userInfo":"/user","accessToken":"/accesstoken","msgs":"/messages"};Object.keys(i).forEach(function(e){i[e]="https://cnodejs.org/api/v1"+i[e]});var u=i,s=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var c=function(){function fetchData(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,fetchData)}return s(fetchData,null,[{"key":"getTopicList","value":function getTopicList(e){return a(u.topics,"GET",e)}},{"key":"getTopicDetail","value":function getTopicDetail(e,n){var t=n||"";return a(u.topic+"/"+e,"GET",{"accesstoken":t})}},{"key":"userLogin","value":function userLogin(e){return a(u.accessToken,"POST",{"accesstoken":e})}},{"key":"getUserInfo","value":function getUserInfo(e){return a(u.userInfo+"/"+e,"GET")}},{"key":"fetchMessages","value":function fetchMessages(e){return a(u.msgs,"GET",{"accesstoken":e})}}]),fetchData}();n.a=c},"48":function(e,n,t){"use strict";t.d(n,"a",function(){return a}),t.d(n,"c",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"b",function(){return p});var r=t(41),o=t(5);function _asyncToGenerator(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function step(r,o){try{var a=n[r](o),i=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}var a=function accessUserToken(e){return n=_asyncToGenerator(regeneratorRuntime.mark(function _callee(n){var t;return regeneratorRuntime.wrap(function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.userLogin(e);case 3:return(t=o.sent).data.success?n(i(t.data,e)):n(u()),o.abrupt("return",t.data);case 8:o.prev=8,o.t0=o.catch(0),console.log(o.t0);case 11:case"end":return o.stop()}},_callee,void 0,[[0,8]])})),function(e){return n.apply(this,arguments)};var n},i=function _accessUserToken(e,n){return{"type":o.a,"userData":e,"token":n}},u=function _accessUserTokenFailed(){return{"type":o.b}},s=function userInfo(e){return n=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(n){var t;return regeneratorRuntime.wrap(function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.getUserInfo(e);case 3:t=o.sent,n(c(t.data.data)),o.next=10;break;case 7:o.prev=7,o.t0=o.catch(0),console.log(o.t0);case 10:case"end":return o.stop()}},_callee2,void 0,[[0,7]])})),function(e){return n.apply(this,arguments)};var n},c=function _userInfo(e){return{"type":o.d,"userData":e}},l=function userLogout(){return{"type":o.e}},p=function getMessages(e){return n=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(n){var t;return regeneratorRuntime.wrap(function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.fetchMessages(e);case 3:t=o.sent,n(f(t.data.data)),o.next=10;break;case 7:o.prev=7,o.t0=o.catch(0),console.log(o.t0);case 10:case"end":return o.stop()}},_callee3,void 0,[[0,7]])})),function(e){return n.apply(this,arguments)};var n},f=function _getMessages(e){return{"type":o.c,"messages":e}}},"77":function(e,n,t){(e.exports=t(38)(!1)).push([e.i,"input {\n  display: block;\n  height: 1.4rem;\n  text-align: inherit;\n  text-overflow: clip;\n  overflow: hidden;\n  white-space: nowrap;\n}",""])},"78":function(e,n,t){var r=t(77);"string"==typeof r&&(r=[[e.i,r,""]]);var o={"sourceMap":!1,"insertAt":"top","hmr":!0,"transform":void 0,"insertInto":void 0};t(37)(r,o);r.locals&&(e.exports=r.locals)},"80":function(e,n,t){}}]);